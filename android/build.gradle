buildscript {
    ext {
        buildToolsVersion = "36.0.0"
        minSdkVersion = 24
        compileSdkVersion = 36
        targetSdkVersion = 36
        ndkVersion = "27.1.12297006"
        kotlinVersion = "2.1.20"
    }
    repositories {
        google()
        mavenCentral()
    }
    dependencies {
        classpath("com.android.tools.build:gradle")
        classpath("com.facebook.react:react-native-gradle-plugin")
        classpath("org.jetbrains.kotlin:kotlin-gradle-plugin")
    }
}

apply plugin: "com.facebook.react.rootproject"

// 모든 서브프로젝트에 minSdkVersion 강제 적용 (라이브러리 호환성)
subprojects { subproject ->
    subproject.plugins.withId('com.android.library') {
        subproject.android {
            defaultConfig {
                minSdkVersion rootProject.ext.minSdkVersion
            }
            // Android 12+ 호환성: 테스트 매니페스트의 android:exported 충돌 해결
            testOptions {
                execution 'ANDROIDX_TEST_ORCHESTRATOR'
            }
        }
    }
    subproject.plugins.withId('com.android.application') {
        subproject.android {
            defaultConfig {
                minSdkVersion rootProject.ext.minSdkVersion
            }
        }
    }
    
    // 외부 라이브러리의 오래된 테스트 의존성 업그레이드
    subproject.configurations.all {
        resolutionStrategy {
            force 'androidx.test:core:1.5.0'
            force 'androidx.test.ext:junit:1.1.5'
            force 'androidx.test.espresso:espresso-core:3.5.1'
        }
    }
}
